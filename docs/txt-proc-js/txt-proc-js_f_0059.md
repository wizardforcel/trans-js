| 配方 48 | 使用负前瞻测试模式 |
| --- | --- |

### 任务

假设你想匹配除了41、66和77以外的任何两位数字，因为这些是退役球衣号码，所以你希望确保它们不会重新分配给新球员。

你可以使用多个字符类来匹配00到40、42到65、67到76以及78到99之间的范围。但最终你会得到一个非常长且复杂的模式。幸运的是，有一种更简洁的方法，通过前瞻断言可以得到相同的结果。

### 解决方案

使用负前瞻断言，表示为(?! ... )：

[part_2/negative_lookahead/negative_lookahead_ex1.js](http://media.pragprog.com/titles/fkjavascript/code/part_2/negative_lookahead/negative_lookahead_ex1.js)

|   | **const** re = */#**(?!**41&#124;66&#124;77**)\d{2}**/* |
| --- | --- |
|   |  |
|   | re.test(*"#00"*); *// → true* |
|   | re.test(*"#39"*); *// → true* |
|   | re.test(*"#41"*); *// → false* |
|   | re.test(*"#66"*); *// → false* |
|   | re.test(*"#77"*); *// → false* |
|   | re.test(*"#98"*); *// → true* |

负前瞻匹配一个不被另一个模式跟随的模式。在这段代码中，负前瞻确保在“#”后面跟的字符串不是“41”，“66”或“77”。

### 讨论

负前瞻是一种非捕获组，表示语法(?! ... )，其中...表示在字符串当前位置之后不应该出现的模式。

让我们来看一下引擎如何解释正则表达式 /#(?!(41|66|77))\d{2}/，并应用于字符串“#39”：

|   | #39 |
| --- | --- |
|   | &#124; |
|   | # 匹配字面上的井号符号。 |
|   |  |
|   | #39 |
|   | &#124; |
|   | (?!41&#124;66&#124;77) 成功匹配一个不是41、66或77的字符串。 |
|   | 指针仍然停留在#。 |
|   |  |
|   | #39 |
|   | &#124; |
|   | \d 匹配一个数字。 |
|   |  |
|   | #39 |
|   | &#124; |
|   | \d 匹配一个数字。 |

向前查找让你检查是否可以匹配某个特定字符串，而不实际进行匹配。当你想确保一个模式后面没有跟随另一个模式时，使用负向向前查找。

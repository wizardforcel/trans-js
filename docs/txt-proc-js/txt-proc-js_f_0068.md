| 食谱56 | 验证社会保障号码 |
| --- | --- |

### 任务

假设你有一个贷款申请表（或许是背景调查表），你想要进行检查，确保用户提供的社会保障号码（SSN）符合SSN的标准格式。

SSN是一个九位数字，分为三部分，通过连字符分隔：AAA-GG-SSSS。前三位数字被称为地区号，曾经是根据地理区域分配的。但它不能是000、666或在900到999之间。

组号由第四位和第五位数字组成，范围从01到99。最后四位数字被称为序列号，范围从0001到9999。你需要一个符合所有这些规则的解决方案，以便快速识别无效的SSN。

### 解决方案

使用以下函数：

[part_3/validating_ssn/ssn_ex1.js](http://media.pragprog.com/titles/fkjavascript/code/part_3/validating_ssn/ssn_ex1.js)

|   | **function** isValidSSN(ssn) { |
| --- | --- |
|   | **const** re = */^**(?!**666&#124;000**)[**0-8**]\d{2}**-**(?!**00**)\d{2}**-**(?!**0000**)\d{4}**$/*; |
|   | **return** re.test(ssn); |
|   | } |
|   |  |
|   | isValidSSN(*"123-45-6789"*); *// → true* |
|   | isValidSSN(*"123-456-789"*); *// → false* |
|   | isValidSSN(*"123-00-6789"*); *// → false* |
|   | isValidSSN(*"666-45-6789"*); *// → false* |

这个函数确保SSN的格式正确，且包含正确的数字数量，从而最小化数据输入错误。

### 讨论

本食谱中的正则表达式匹配符合XXX-XX-XXXX格式的有效SSN，其中前三位数字不能是666或000，第四和第五位数字不能是00，最后四位数字不能是0000。

(?!000|666) 在模式开头的否定前瞻断言，防止匹配以 666 或 000 开头的社会保障号码，因为这些是无效的社会保障号码。该模式匹配第二组和第三组数字中的任何两位或四位数字。但它事先加入了一个否定前瞻，以避免匹配零。

以下是带有每个部分解释的正则表达式模式：

|   | /^(?!666&#124;000)[0-8]\d{2}-(?!00)\d{2}-(?!0000)\d{4}$/ |
| --- | --- |
|   |  |
|   | ● ^ 确保字符串开头的位置 |
|   | ● (?!666&#124;000) 否定前瞻：确保正则表达式下方不匹配。 |
|   | ○ 第一个选择 |
|   | ○ 666 匹配字符 666 |
|   | ○ 第二个选择 |
|   | ○ 000 匹配字符 000 |
|   | ● [0-8] 匹配 0 到 8 之间的任意一个字符 |
|   | ● \d 匹配一个数字 |
|   | ○ {2} 精确匹配前一个标记 2 次 |
|   | ● - 匹配一个连字符 |
|   | ● (?!00) 否定前瞻：确保正则表达式不匹配 00 |
|   | ● \d 匹配一个数字 |
|   | ○ {2} 精确匹配前一个标记 2 次 |
|   | ● - 匹配一个连字符 |
|   | ● (?!0000) 否定前瞻：确保正则表达式不匹配 0000 |
|   | ● \d 匹配一个数字 |
|   | ○ {4} 精确匹配前一个标记 4 次 |
|   | ● $ 确保字符串末尾的位置 |

在确认所提供的值符合社会保障号码的标准格式后，你可以考虑采取更严格的方法，即通过社会保障管理局核实该号码是否对应某个现有个人。^([[35]](f_0087.xhtml#FOOTNOTE-35))

请记住，验证社会保障号码的重要性，以避免在处理重要文件（如正式记录）时发生行政错误。

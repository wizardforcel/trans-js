## 堆插入

要将新值插入堆中，我们执行以下算法：

1.  我们创建一个包含新值的节点，并将其插入到底层的下一个可用最右侧位置。因此，这个值成为堆的最后一个节点。

1.  接下来，我们将这个新节点与其父节点进行比较。

1.  如果新节点大于其父节点，我们将新节点与父节点交换。

1.  我们重复第三步，有效地将新节点向上移动直到新节点的父节点的值大于它。

让我们看看这个算法的实际操作。如果我们将`40`插入堆中，会发生什么。

第一步：我们将`40`添加为堆的最后一个节点：

![images/heaps/add_40.png](images/heaps/add_40.png)

请注意，进行以下操作是不正确的：

![images/heaps/incorrect_add_40.png](images/heaps/incorrect_add_40.png)

将`40`放置为`12`节点的子节点会使树不完整，因为现在我们在一个空位置的右侧有一个节点。为了保持堆的性质，它必须始终是完整的。

第二步：我们将`40`与其父节点进行比较，父节点是`8`。由于`40`大于`8`，我们交换这两个节点：

![images/heaps/swap_40_with_8.png](images/heaps/swap_40_with_8.png)

第三步：我们将`40`与其新父节点`25`进行比较。由于`40`大于`25`，我们交换它们：

![images/heaps/swap_40_with_25.png](images/heaps/swap_40_with_25.png)

第四步：我们将`40`与其父节点`100`进行比较。由于`40`小于`100`，我们完成了！

将新节点向上移动的过程称为在堆中向上滴落节点。有时它向右移动，有时向左移动，但它始终向上移动，直到安置在正确的位置。

向堆中插入的效率为`O(log N)`。正如你在前一章中看到的，对于任何二叉树中的`N`个节点，该树大约组织成`log(N)`行。由于我们最多只需将新值向上滴落到顶层，这最多需要`log(N)`步。
